# Then use relocate to move the new column to the far left
afl1<-relocate(afl1,"RowNum", .before = Team)
afl1
# Use filter to extract the rows without text data.
afl1<-filter(afl1,Team!="testX1")
# Make sure the row numbers are updated
afl1<-mutate(afl1,RowNum=c(1:17))
afl1
# Change Team name "Adelaide" to "Port Adelaide"
afl1[9,]$Team<-str_replace(afl1[9,]$Team,"Adelaide","Port Adelaide")
# Change Team name "Melbourne" to "North Melbourne"
afl1[14,]$Team<-str_replace(afl1[14,]$Team,"Melbourne","North Melbourne")
# Change State "Queensld" to "QLD"
afl1[4,]$State<-str_replace(afl1[4,]$State,"Queensld","QLD")
# Change State "New South Wales" to "SA"
afl1[9,]$State<-str_replace(afl1[9,]$State,"New South Wales","SA")
# Change State "bictoria" to "VIC"
afl1[15,]$State<-str_replace(afl1[15,]$State,"bictoria","VIC")
afl1
# Use arrange to sort the tibble by team name
afl1<-arrange(afl1,Team)
afl1
# Use gather to convert the data set to long form
afl1<- gather(afl1,key = "round",value = "details",'Round01':'Round22')
afl1
# Use sting replace to remove all the "Round" string in column round
afl1$round<-str_replace(afl1$round,"Round","")
afl1
# Judge is away in details column, and rename the result column 1 into home
afl1<-afl1 %>%
mutate("home"=is.na(str_match(afl1$details,"away"))[,1])
afl1
# Dig the numbers by str_match and put the result into column goals and column behinds
afl1<-mutate(afl1,goals=str_match(afl1$details,"(\\d+) goals and (\\d+)")[,2])
afl1<-mutate(afl1,behinds=str_match(afl1$details,"(\\d+) goals and (\\d+)")[,3])
afl1
# Delete the details column
afl1<-mutate(afl1,details=NULL)
afl1
# Add the TidyRowNum column right next to the origin RowNum
afl1<-mutate(afl1,TidyRowNum=(1:374), .after=RowNum)
afl1
View(afl)
View(afl1)
View(afl1)
View(afl)
View(afl1)
View(afl1)
View(afl)
afl1
# Change the blank spaces in Team into "_"
afl1<-str_replace(afl1$Team," ","_")
afl1
# Change the blank spaces in Team into "_"
afl1<-str_replace(afl1$Team," ","_")
# Change the blank spaces in Team into "_"
afl1<-str_replace(afl1$Team," ","_")
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
#Load the required packages
library(tidyverse)
library(inspectdf)
library(lubridate)
library(caret)
library(moments)
library(tidymodels)
library(ISLR)
library(car)
# Your student number goes here
ysn = 1942340
# Calculate your student number modulo 3
filenum <- ysn %% 3
filenum
filename <- paste0("./data/afl_",filenum,".csv")
filename
# Read in the data
afl<-read_csv("./data/afl_2.csv")
# Display the first 10 lines of the data
head(afl,10)
#Use dim to show the numbers of rows and columns
dim(afl)
# Set the random seed
set.seed(1942340)
# Use sample_n to get the random permutation of the rows
afl1<-sample_n(afl,18,replace = FALSE)
afl1
# Use mutate to add a column at the far right of the data set
afl1<-mutate(afl1,RowNum=c(1:18))
# Then use relocate to move the new column to the far left
afl1<-relocate(afl1,"RowNum", .before = Team)
afl1
# Use filter to extract the rows without text data.
afl1<-filter(afl1,Team!="testX1")
# Make sure the row numbers are updated
afl1<-mutate(afl1,RowNum=c(1:17))
afl1
# Change Team name "Adelaide" to "Port Adelaide"
afl1[9,]$Team<-str_replace(afl1[9,]$Team,"Adelaide","Port Adelaide")
# Change Team name "Melbourne" to "North Melbourne"
afl1[14,]$Team<-str_replace(afl1[14,]$Team,"Melbourne","North Melbourne")
# Change State "Queensld" to "QLD"
afl1[4,]$State<-str_replace(afl1[4,]$State,"Queensld","QLD")
# Change State "New South Wales" to "SA"
afl1[9,]$State<-str_replace(afl1[9,]$State,"New South Wales","SA")
# Change State "bictoria" to "VIC"
afl1[15,]$State<-str_replace(afl1[15,]$State,"bictoria","VIC")
afl1
# Use arrange to sort the tibble by team name
afl1<-arrange(afl1,Team)
afl1
# Use gather to convert the data set to long form
afl1<- gather(afl1,key = "round",value = "details",'Round01':'Round22')
afl1
# Use sting replace to remove all the "Round" string in column round
afl1$round<-str_replace(afl1$round,"Round","")
afl1
# Judge is away in details column, and rename the result column 1 into home
afl1<-afl1 %>%
mutate("home"=is.na(str_match(afl1$details,"away"))[,1])
afl1
# Dig the numbers by str_match and put the result into column goals and column behinds
afl1<-mutate(afl1,goals=str_match(afl1$details,"(\\d+) goals and (\\d+)")[,2])
afl1<-mutate(afl1,behinds=str_match(afl1$details,"(\\d+) goals and (\\d+)")[,3])
afl1
# Delete the details column
afl1<-mutate(afl1,details=NULL)
afl1
# Add the TidyRowNum column right next to the origin RowNum
afl1<-mutate(afl1,TidyRowNum=(1:374), .after=RowNum)
afl1
# Change the blank spaces in Team into "_"
afl1<-str_replace(afl1$Team," ","_")
afl1
# Change the blank spaces in Team into "_"
afl1$Team<-str_replace(afl1$Team," ","_")
# Change the blank spaces in Team into "_"
afl1$Team<-str_replace(afl1$Team," ","_")
# Change the blank spaces in Team into "_"
afl1$Team<-str_replace(afl1$Team," ","_")
# Add the TidyRowNum column right next to the origin RowNum
afl1<-mutate(afl1,TidyRowNum=(1:374), .after=RowNum)
# Add the TidyRowNum column right next to the origin RowNum
afl1<-mutate(afl1,TidyRowNum=(1:374), .after=RowNum)
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
#Load the required packages
library(tidyverse)
library(inspectdf)
library(lubridate)
library(caret)
library(moments)
library(tidymodels)
library(ISLR)
library(car)
# Your student number goes here
ysn = 1942340
# Calculate your student number modulo 3
filenum <- ysn %% 3
filenum
filename <- paste0("./data/afl_",filenum,".csv")
filename
# Read in the data
afl<-read_csv("./data/afl_2.csv")
# Display the first 10 lines of the data
head(afl,10)
#Use dim to show the numbers of rows and columns
dim(afl)
# Set the random seed
set.seed(1942340)
# Use sample_n to get the random permutation of the rows
afl1<-sample_n(afl,18,replace = FALSE)
afl1
# Use mutate to add a column at the far right of the data set
afl1<-mutate(afl1,RowNum=c(1:18))
# Then use relocate to move the new column to the far left
afl1<-relocate(afl1,"RowNum", .before = Team)
afl1
# Use filter to extract the rows without text data.
afl1<-filter(afl1,Team!="testX1")
# Make sure the row numbers are updated
afl1<-mutate(afl1,RowNum=c(1:17))
afl1
# Change Team name "Adelaide" to "Port Adelaide"
afl1[9,]$Team<-str_replace(afl1[9,]$Team,"Adelaide","Port Adelaide")
# Change Team name "Melbourne" to "North Melbourne"
afl1[14,]$Team<-str_replace(afl1[14,]$Team,"Melbourne","North Melbourne")
# Change State "Queensld" to "QLD"
afl1[4,]$State<-str_replace(afl1[4,]$State,"Queensld","QLD")
# Change State "New South Wales" to "SA"
afl1[9,]$State<-str_replace(afl1[9,]$State,"New South Wales","SA")
# Change State "bictoria" to "VIC"
afl1[15,]$State<-str_replace(afl1[15,]$State,"bictoria","VIC")
afl1
# Use arrange to sort the tibble by team name
afl1<-arrange(afl1,Team)
afl1
# Use gather to convert the data set to long form
afl1<- gather(afl1,key = "round",value = "details",'Round01':'Round22')
afl1
# Use sting replace to remove all the "Round" string in column round
afl1$round<-str_replace(afl1$round,"Round","")
afl1
# Judge is away in details column, and rename the result column 1 into home
afl1<-afl1 %>%
mutate("home"=is.na(str_match(afl1$details,"away"))[,1])
afl1
# Dig the numbers by str_match and put the result into column goals and column behinds
afl1<-mutate(afl1,goals=str_match(afl1$details,"(\\d+) goals and (\\d+)")[,2])
afl1<-mutate(afl1,behinds=str_match(afl1$details,"(\\d+) goals and (\\d+)")[,3])
afl1
# Delete the details column
afl1<-mutate(afl1,details=NULL)
afl1
# Add the TidyRowNum column right next to the origin RowNum
afl1<-mutate(afl1,TidyRowNum=(1:374), .after=RowNum)
afl1
# Change the blank spaces in Team into "_"
afl1$Team<-str_replace(afl1$Team," ","_")
# Change the blank spaces in Team into "_"
afl1$Team<-str_replace(afl1$Team," ","_")
afl1
# Check if there is any NA
is.na(afl1)
# Check if there is any NA
inspect_na(afl1)
afl2<-sample_n(afl1,200)
afl2
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
#Load the required packages
library(tidyverse)
library(inspectdf)
# Your student number goes here
ysn = 1942340
# Calculate your student number modulo 3
filenum <- ysn %% 3
filenum
filename <- paste0("./data/afl_",filenum,".csv")
filename
# Read in the data
afl<-read_csv("./data/afl_2.csv")
# Display the first 10 lines of the data
head(afl,10)
#Use dim to show the numbers of rows and columns
dim(afl)
# Set the random seed
set.seed(1942340)
# Use sample_n to get the random permutation of the rows
afl1<-sample_n(afl,18,replace = FALSE)
afl1
# Use mutate to add a column at the far right of the data set
afl1<-mutate(afl1,RowNum=c(1:18))
# Then use relocate to move the new column to the far left
afl1<-relocate(afl1,"RowNum", .before = Team)
afl1
# Use filter to extract the rows without text data.
afl1<-filter(afl1,Team!="testX1")
# Make sure the row numbers are updated
afl1<-mutate(afl1,RowNum=c(1:17))
afl1
# Change Team name "Adelaide" to "Port Adelaide"
afl1[9,]$Team<-str_replace(afl1[9,]$Team,"Adelaide","Port Adelaide")
# Change Team name "Melbourne" to "North Melbourne"
afl1[14,]$Team<-str_replace(afl1[14,]$Team,"Melbourne","North Melbourne")
# Change State "Queensld" to "QLD"
afl1[4,]$State<-str_replace(afl1[4,]$State,"Queensld","QLD")
# Change State "New South Wales" to "SA"
afl1[9,]$State<-str_replace(afl1[9,]$State,"New South Wales","SA")
# Change State "bictoria" to "VIC"
afl1[15,]$State<-str_replace(afl1[15,]$State,"bictoria","VIC")
afl1
# Use arrange to sort the tibble by team name
afl1<-arrange(afl1,Team)
afl1
# Use gather to convert the data set to long form
afl1<- gather(afl1,key = "round",value = "details",'Round01':'Round22')
afl1
# Use sting replace to remove all the "Round" string in column round
afl1$round<-str_replace(afl1$round,"Round","")
afl1
# Judge is away in details column, and rename the result column 1 into home
afl1<-afl1 %>%
mutate("home"=is.na(str_match(afl1$details,"away"))[,1])
afl1
# Dig the numbers by str_match and put the result into column goals and column behinds
afl1<-mutate(afl1,goals=str_match(afl1$details,"(\\d+) goals and (\\d+)")[,2])
afl1<-mutate(afl1,behinds=str_match(afl1$details,"(\\d+) goals and (\\d+)")[,3])
afl1
# Delete the details column
afl1<-mutate(afl1,details=NULL)
afl1
# Add the TidyRowNum column right next to the origin RowNum
afl1<-mutate(afl1,TidyRowNum=(1:374), .after=RowNum)
afl1
# Change the blank spaces in Team into "_"
afl1$Team<-str_replace(afl1$Team," ","_")
afl1
# Check if there is any NA
inspect_na(afl1)
set.seed(1942340)
afl2<-sample_n(afl1,200)
afl2
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
#Load the required packages
library(tidyverse)
library(inspectdf)
# Your student number goes here
ysn = 1942340
# Calculate your student number modulo 3
filenum <- ysn %% 3
filenum
filename <- paste0("./data/afl_",filenum,".csv")
filename
# Read in the data
afl<-read_csv("./data/afl_2.csv")
# Display the first 10 lines of the data
head(afl,10)
#Use dim to show the numbers of rows and columns
dim(afl)
# Set the random seed
set.seed(1942340)
# Use sample_n to get the random permutation of the rows
afl1<-sample_n(afl,18,replace = FALSE)
afl1
# Use mutate to add a column at the far right of the data set
afl1<-mutate(afl1,RowNum=c(1:18))
# Then use relocate to move the new column to the far left
afl1<-relocate(afl1,"RowNum", .before = Team)
afl1
# Use filter to extract the rows without text data.
afl1<-filter(afl1,Team!="testX1")
# Make sure the row numbers are updated
afl1<-mutate(afl1,RowNum=c(1:17))
afl1
# Change Team name "Adelaide" to "Port Adelaide"
afl1[9,]$Team<-str_replace(afl1[9,]$Team,"Adelaide","Port Adelaide")
# Change Team name "Melbourne" to "North Melbourne"
afl1[14,]$Team<-str_replace(afl1[14,]$Team,"Melbourne","North Melbourne")
# Change State "Queensld" to "QLD"
afl1[4,]$State<-str_replace(afl1[4,]$State,"Queensld","QLD")
# Change State "New South Wales" to "SA"
afl1[9,]$State<-str_replace(afl1[9,]$State,"New South Wales","SA")
# Change State "bictoria" to "VIC"
afl1[15,]$State<-str_replace(afl1[15,]$State,"bictoria","VIC")
afl1
# Use arrange to sort the tibble by team name
afl1<-arrange(afl1,Team)
afl1
# Use gather to convert the data set to long form
afl1<- gather(afl1,key = "round",value = "details",'Round01':'Round22')
afl1
# Use sting replace to remove all the "Round" string in column round
afl1$round<-str_replace(afl1$round,"Round","")
afl1
# Judge is away in details column, and rename the result column 1 into home
afl1<-afl1 %>%
mutate("home"=is.na(str_match(afl1$details,"away"))[,1])
afl1
# Dig the numbers by str_match and put the result into column goals and column behinds
afl1<-mutate(afl1,goals=str_match(afl1$details,"(\\d+) goals and (\\d+)")[,2])
afl1<-mutate(afl1,behinds=str_match(afl1$details,"(\\d+) goals and (\\d+)")[,3])
afl1
# Delete the details column
afl1<-mutate(afl1,details=NULL)
afl1
# Add the TidyRowNum column right next to the origin RowNum
afl1<-mutate(afl1,TidyRowNum=(1:374), .after=RowNum)
afl1
# Change the blank spaces in Team into "_"
afl1$Team<-str_replace(afl1$Team," ","_")
afl1
# Check if there is any NA
inspect_na(afl1)
set.seed(1942340)
afl2<-sample_n(afl1,200)
afl2
# Change the blank spaces in Team into "_"
afl1$Team<-str_replace(afl1$Team," ","_")
afl1
# Change the round numbers into integers'
afl1$round<-as.integer(afl1$round)
# Check if there is any NA
inspect_na(afl1)
set.seed(1942340)
afl2<-sample_n(afl1,200)
afl2
# Change the blank spaces in Team into "_"
afl1$Team<-str_replace(afl1$Team," ","_")
afl1
# Change the number characters into integers
afl1$round<-as.integer(afl1$round)
afl1$goals<-as.integer(afl1$goals)
afl1$behinds<-as.integer(afl1$behinds)
# Check if there is any NA
inspect_na(afl1)
set.seed(1942340)
afl2<-sample_n(afl1,200)
afl2
# Calculate the score and accuracy and insert the new colunms
afl2<-mutate(afl2,score=goals*6+behinds)
afl2<-mutate(afl2,accuracy=goals/(goals+behinds))
afl2
afl2
afl2$score<-as.integer(afl2$score)
afl2
inspect_num(afl2)
stat1<-inspect_num(afl2)
View(afl2)
View(stat1)
View(stat1[[10]][[6]])
summarise(group_by(afl2,team),mean_score=mean(score))
summarise(group_by(afl2,Team),mean_score=mean(score))
summarise(group_by(afl2,Team),mean_score=mean(score))
summarise(group_by(afl2,Team),mean_accuracy=mean(accuracy)
summarise(group_by(afl2,Team),mean_score=mean(score))
summarise(group_by(afl2,Team),mean_accuracy=mean(accuracy))
ggplot(afl2,aes(score,home))+
geom_boxplot(fill=home)
ggplot(afl2,aes(score,fill=home))+
geom_boxplot()
ggplot(afl2,aes(fill=home,score))+
geom_boxplot()
ggplot(afl2,aes(score,home,fill=home))+
geom_boxplot()
ggplot(afl2,aes(home,score,fill=home))+
geom_boxplot()
ggplot(afl2,aes(home,accuracy,fill=home))+
geom_boxplot()
afl_home<-filter(afl2$home==True)
afl_home<-filter(afl2$home==TRUE)
afl_home<-filter(afl2,home==TRUE)
afl_home<-filter(afl2,home==TRUE)
afl_away<-filte(afl2,home==FALSE)
afl_home<-filter(afl2,home==TRUE)
afl_away<-filter(afl2,home==FALSE)
afl_home
afl_away
inspect_num(afl_home)
inspect_num(afl_away)
df_home<-tibble(
x=afl_home$accuracy,
y=afl_home$score
)
df_lm<-lm(y~x,df_home)
summary(df_lm)
df_home<-tibble(
x=afl_home$accuracy,
y=afl_home$score
)
df_lm<-lm(y~x,df_home)
summary(df_lm)
plot(df_lm,which=3)
df_home<-tibble(
x=afl_home$score,
y=afl_home$accuracy
)
df_lm<-lm(y~x,df_home)
summary(df_lm)
plot(df_lm,which=3)
df_home<-tibble(
x=afl_home$accuracy,
y=afl_home$score
)
df_lm<-lm(y~x,df_home)
summary(df_lm)
plot(df_lm,which=1)
df_home<-tibble(
x=afl_home$accuracy,
y=afl_home$score
)
df_lm<-lm(x~y,df_home)
summary(df_lm)
plot(df_lm,which=1)
df_home<-tibble(
x=afl_home$accuracy,
y=afl_home$score
)
df_lm<-lm(x~y,df_home)
summary(df_lm)
plot(df_lm,which=2)
df_home<-tibble(
x=afl_home$accuracy,
y=afl_home$score
)
df_lm<-lm(y~x,df_home)
summary(df_lm)
plot(df_lm,which=2)
df_home<-tibble(
x=afl_home$accuracy,
y=afl_home$score
)
df_lm<-lm(y~x,df_home)
summary(df_lm)
plot(df_lm,which=1)
df_home<-tibble(
x=afl_home$score,
y=afl_home$accuracy
)
df_lm<-lm(y~x,df_home)
summary(df_lm)
plot(df_lm,which=1)
ggplot(afl_home, aes(x = accuracy, y = score)) +
geom_point()
ggplot(afl_home, aes(x = accuracy, y = score)) +
geom_point() +
geom_smooth(method="lm")
ggplot(afl_home, aes(x = accuracy, y = score)) +
geom_point() +
geom_smooth(method="lm")
ggplot(afl_away, aes(x = accuracy, y = score)) +
geom_point() +
geom_smooth(method="lm")
source("C:/Users/secar/OneDrive/UOA/mds2024t2/7107datatming/dt_a1/dt_a1.R")
source("C:/Users/secar/OneDrive/UOA/mds2024t2/7107datatming/dt_a1/dt_a1.R")
source("C:/Users/secar/OneDrive/UOA/mds2024t2/7107datatming/dt_a1/dt_a1.R")
